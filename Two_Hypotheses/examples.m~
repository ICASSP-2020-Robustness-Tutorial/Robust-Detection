% Example for least favorable densities under band uncertainty

% Sample space
dx = 0.01;
x = -8:dx:8;

% nominal densities
p0 = normpdf(x, -2, 2);
p1 = normpdf(x, 1, 1);
P = [p0; p1];

% LFDs under density band uncertainty

% bands
P_min(1, :) = 0.8 * p0;
P_min(2, :) = 0.8 * p1;
p_max(1, :) = 1.2 * p0;
p_max(2, :) = 1.2 * p1;

% solve for LFDs
[Q, llr, c, nit] = lfds_density_band(P_min, p_max, dx);

% plot lfds
figure;
plot(x, Q(1,:), x, Q(2,:))
legend('q_0', 'q_1')
title('Density band uncertainty')

% plot log-likelihood ratio
figure;
plot(x, llr)
legend('log-likelihood ratio')
title('Density band uncertainty')

% LFDs under 10% and 15% contamination (outliers)
 
eps = [0.1, 0.15];
 
% solve for LFDs
[Q, llr, c] = lfds_outliers(p0, p1, dx, eps);

% plot lfds
figure;
plot(x, q0, x, q1)
legend('q_0', 'q_1')
title('Epsilon Contamination')

% plot log-likelihood ratio
figure;
plot(x, llr)
legend('log-likelihood ratio')
title('Epsilon Contamination')
